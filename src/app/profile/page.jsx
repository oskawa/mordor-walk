"use client";

import { useEffect, useState } from "react";
import axios from "axios";
import FriendsComponent from "../components/profile/FriendsComponent";
import OverviewComponent from "../components/profile/OverviewComponent";
import StravaComponent from "../components/profile/StravaComponent";
import styles from "./profile.module.scss";
import Link from "next/link";

const NEXT_PUBLIC_WORDPRESS_REST_GLOBAL_ENDPOINT =
  process.env.NEXT_PUBLIC_WORDPRESS_REST_GLOBAL_ENDPOINT;

const Profile = () => {
  // const [loading, setLoading] = useState(true);
  const [activeMenu, setActiveMenu] = useState("overview");

  // if (loading) {
  //   return <div>Chargement</div>;
  // }

  useEffect(() => {
    const urlParams = new URLSearchParams(window.location.search);
    const stravaCallback = urlParams.get("stravaCallback");
    if (stravaCallback) {
      setActiveMenu("stravaedit");
    }
  }, []);

  return (
    <>
      <div className={styles.profile}>
        <nav>
          <ul>
            <li onClick={() => setActiveMenu("overview")}>
              <svg
                width="16"
                height="18"
                viewBox="0 0 16 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M2 16H5V11C5 10.7167 5.096 10.4793 5.288 10.288C5.48 10.0967 5.71733 10.0007 6 10H10C10.2833 10 10.521 10.096 10.713 10.288C10.905 10.48 11.0007 10.7173 11 11V16H14V7L8 2.5L2 7V16ZM0 16V7C0 6.68333 0.0709998 6.38333 0.213 6.1C0.355 5.81667 0.550667 5.58333 0.8 5.4L6.8 0.9C7.15 0.633333 7.55 0.5 8 0.5C8.45 0.5 8.85 0.633333 9.2 0.9L15.2 5.4C15.45 5.58333 15.646 5.81667 15.788 6.1C15.93 6.38333 16.0007 6.68333 16 7V16C16 16.55 15.804 17.021 15.412 17.413C15.02 17.805 14.5493 18.0007 14 18H10C9.71667 18 9.47933 17.904 9.288 17.712C9.09667 17.52 9.00067 17.2827 9 17V12H7V17C7 17.2833 6.904 17.521 6.712 17.713C6.52 17.905 6.28267 18.0007 6 18H2C1.45 18 0.979333 17.8043 0.588 17.413C0.196666 17.0217 0.000666667 16.5507 0 16Z"
                  fill="white"
                />
              </svg>
              Général
            </li>
            <li
              onClick={() => setActiveMenu("stravaedit")}
              className={activeMenu === "stravaedit" ? `${styles.active}` : ""}
            >
              <svg
                width="14"
                height="12"
                viewBox="0 0 14 12"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9 4V5H6C5.46957 5 4.96086 5.21071 4.58579 5.58579C4.21071 5.96086 4 6.46957 4 7V9C4 9.53043 4.21071 10.0391 4.58579 10.4142C4.96086 10.7893 5.46957 11 6 11H11C11.5304 11 12.0391 10.7893 12.4142 10.4142C12.7893 10.0391 13 9.53043 13 9V7C13 6.64894 12.9076 6.30406 12.732 6.00003C12.5565 5.696 12.304 5.44353 12 5.268V4.17C13.165 4.582 14 5.693 14 6.999V8.999C14 9.79465 13.6839 10.5577 13.1213 11.1203C12.5587 11.6829 11.7956 11.999 11 11.999H6C5.20435 11.999 4.44129 11.6829 3.87868 11.1203C3.31607 10.5577 3 9.79465 3 8.999V7C3 6.20435 3.31607 5.44129 3.87868 4.87868C4.44129 4.31607 5.20435 4 6 4H9Z"
                  fill="#F7EBFF"
                />
                <path
                  d="M5 8V7H8C8.53043 7 9.03914 6.78929 9.41421 6.41421C9.78929 6.03914 10 5.53043 10 5V3C10 2.46957 9.78929 1.96086 9.41421 1.58579C9.03914 1.21071 8.53043 1 8 1H3C2.46957 1 1.96086 1.21071 1.58579 1.58579C1.21071 1.96086 1 2.46957 1 3V5C1.00001 5.35106 1.09243 5.69594 1.26796 5.99997C1.4435 6.304 1.69597 6.55647 2 6.732V7.83C1.41492 7.623 0.90841 7.23969 0.550228 6.73286C0.192046 6.22603 -0.000188056 5.62062 1.38047e-07 5V3C1.38047e-07 2.20435 0.316071 1.44129 0.87868 0.87868C1.44129 0.316071 2.20435 0 3 0H8C8.79565 0 9.55871 0.316071 10.1213 0.87868C10.6839 1.44129 11 2.20435 11 3V5C11 5.79565 10.6839 6.55871 10.1213 7.12132C9.55871 7.68393 8.79565 8 8 8H5Z"
                  fill="#F7EBFF"
                />
              </svg>
              Connexion Strava
            </li>
            <li onClick={() => setActiveMenu("friends")}>
              <svg
                width="16"
                height="18"
                viewBox="0 0 16 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M8 1.8C7.05701 1.8 6.15264 2.17928 5.48584 2.85442C4.81905 3.52955 4.44444 4.44522 4.44444 5.4C4.44444 6.35478 4.81905 7.27045 5.48584 7.94558C6.15264 8.62072 7.05701 9 8 9C8.94299 9 9.84736 8.62072 10.5142 7.94558C11.181 7.27045 11.5556 6.35478 11.5556 5.4C11.5556 4.44522 11.181 3.52955 10.5142 2.85442C9.84736 2.17928 8.94299 1.8 8 1.8ZM2.66667 5.4C2.66667 3.96783 3.22857 2.59432 4.22876 1.58162C5.22896 0.568927 6.58551 0 8 0C9.41449 0 10.771 0.568927 11.7712 1.58162C12.7714 2.59432 13.3333 3.96783 13.3333 5.4C13.3333 6.83217 12.7714 8.20568 11.7712 9.21838C10.771 10.2311 9.41449 10.8 8 10.8C6.58551 10.8 5.22896 10.2311 4.22876 9.21838C3.22857 8.20568 2.66667 6.83217 2.66667 5.4ZM4.44444 14.4C3.7372 14.4 3.05892 14.6845 2.55883 15.1908C2.05873 15.6972 1.77778 16.3839 1.77778 17.1C1.77778 17.3387 1.68413 17.5676 1.51743 17.7364C1.35073 17.9052 1.12464 18 0.888889 18C0.653141 18 0.427048 17.9052 0.260349 17.7364C0.0936505 17.5676 0 17.3387 0 17.1C0 15.9065 0.468253 14.7619 1.30175 13.918C2.13524 13.0741 3.2657 12.6 4.44444 12.6H11.5556C12.7343 12.6 13.8648 13.0741 14.6983 13.918C15.5317 14.7619 16 15.9065 16 17.1C16 17.3387 15.9064 17.5676 15.7397 17.7364C15.573 17.9052 15.3469 18 15.1111 18C14.8754 18 14.6493 17.9052 14.4826 17.7364C14.3159 17.5676 14.2222 17.3387 14.2222 17.1C14.2222 16.3839 13.9413 15.6972 13.4412 15.1908C12.9411 14.6845 12.2628 14.4 11.5556 14.4H4.44444Z"
                  fill="white"
                />
              </svg>
              Contacts
            </li>
          </ul>
        </nav>
        <div className={styles.profileContent}>
          {activeMenu === "overview" && <OverviewComponent />}
          {activeMenu === "friends" && <FriendsComponent />}
          {activeMenu === "stravaedit" && <StravaComponent />}
        </div>
      </div>
    </>
  );
};

export default Profile;
